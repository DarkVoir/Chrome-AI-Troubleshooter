<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dark Voir AI Troubleshooter</title>
    <link rel="stylesheet" href="popup.css">
</head>
<body>
    <!-- HEADER -->
    <div class="header">
        <div class="logo">
            <span class="logo-icon">üéØ</span>
            <h1>Dark Voir</h1>
        </div>
        <div class="header-actions">
            <div class="ai-status">
                <span class="ai-status-indicator" id="ai-status-indicator"></span>
                <span class="ai-status-text" id="ai-status-text">AI Ready</span>
            </div>
            <button class="icon-btn" id="settings-btn" title="Settings">‚öôÔ∏è</button>
        </div>
    </div>

    <!-- TABS -->
    <div class="tabs">
        <button class="tab-btn active" data-tab="dashboard">
            <span>üìä</span>
            <span>Dashboard</span>
            <span class="badge" id="dashboard-badge" style="display: none;">0</span>
        </button>
        <button class="tab-btn" data-tab="issues">
            <span>‚ö†Ô∏è</span>
            <span>Issues</span>
            <span class="badge" id="issues-badge">0</span>
        </button>
        <button class="tab-btn" data-tab="fixes">
            <span>‚úì</span>
            <span>Fixes</span>
            <span class="badge" id="fixes-badge">0</span>
        </button>
        <button class="tab-btn" data-tab="chat">
            <span>üí¨</span>
            <span>Chat</span>
        </button>
        <button class="tab-btn" data-tab="settings">
            <span>‚öôÔ∏è</span>
            <span>Settings</span>
        </button>
    </div>

    <!-- TAB CONTENT -->
    <div class="tab-content">
        <!-- DASHBOARD TAB -->
        <div class="tab-pane active" id="dashboard">
            <div class="section">
                <h3>üìà Overview</h3>
                <div class="dashboard-overview">
                    <div class="metric-card">
                        <div class="metric-icon status">üìä</div>
                        <div class="metric-info">
                            <span class="metric-value" id="total-issues">0</span>
                            <span class="metric-label">Issues</span>
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon errors">üî¥</div>
                        <div class="metric-info">
                            <span class="metric-value" id="critical-issues">0</span>
                            <span class="metric-label">Critical</span>
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon performance">‚ö°</div>
                        <div class="metric-info">
                            <span class="metric-value" id="resolved-issues">0</span>
                            <span class="metric-label">Fixed</span>
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon ai">ü§ñ</div>
                        <div class="metric-info">
                            <span class="metric-value" id="ai-capability">‚úì</span>
                            <span class="metric-label">AI Status</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <h3>üé¨ Quick Actions</h3>
                <div class="quick-actions">
                    <button class="action-btn primary" id="scan-btn">
                        <span>üîç</span>
                        <span>Scan Page</span>
                    </button>
                    <button class="action-btn primary" id="visual-guide-btn">
                        <span>üëÅÔ∏è</span>
                        <span>Visual Guide</span>
                    </button>
                    <button class="action-btn secondary" id="self-check-btn">
                        <span>üîß</span>
                        <span>Self-Check</span>
                    </button>
                    <button class="action-btn secondary" id="refresh-btn">
                        <span>üîÑ</span>
                        <span>Refresh</span>
                    </button>
                </div>
            </div>

            <div class="section">
                <h3>üìã Recent Activity</h3>
                <div class="activity-list" id="activity-list">
                    <div style="padding: 16px; text-align: center; color: #999; font-size: 12px;">
                        No activity yet. Scan a page to get started!
                    </div>
                </div>
            </div>

            <div class="section">
                <h3>ü§ñ Chrome AI</h3>
                <div style="background: rgba(255, 255, 255, 0.9); padding: 12px; border-radius: 8px; font-size: 11px;">
                    <div id="api-capabilities" style="color: #333;"></div>
                </div>
            </div>
        </div>

        <!-- ISSUES TAB -->
        <div class="tab-pane" id="issues">
            <div class="section">
                <h3>‚ö†Ô∏è Issues Found</h3>
                
                <div class="filter-bar">
                    <select id="severity-filter" class="filter-select">
                        <option value="all">All Severity</option>
                        <option value="critical">Critical</option>
                        <option value="high">High</option>
                        <option value="medium">Medium</option>
                        <option value="low">Low</option>
                    </select>
                    <select id="type-filter" class="filter-select">
                        <option value="all">All Types</option>
                        <option value="javascript_error">JavaScript</option>
                        <option value="network_issue">Network</option>
                        <option value="performance_issue">Performance</option>
                        <option value="form_validation">Validation</option>
                    </select>
                    <button class="btn-clear" id="clear-issues-btn">Clear All</button>
                </div>

                <div class="issues-container" id="issues-list">
                    <div class="empty-state">
                        <p>‚úì No issues detected</p>
                        <p class="empty-state-help">Click "Scan Page" to check for problems</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- FIXES TAB -->
        <div class="tab-pane" id="fixes">
            <div class="fixes-header">
                <h3>‚úì AI-Generated Fixes</h3>
                <div class="fixes-actions">
                    <button class="action-btn secondary" id="generate-all-fixes-btn" style="font-size: 10px; padding: 6px 10px;">
                        <span>ü§ñ</span>
                        Generate All
                    </button>
                    <button class="action-btn secondary" id="export-fixes-btn" style="font-size: 10px; padding: 6px 10px;">
                        <span>üíæ</span>
                        Export
                    </button>
                </div>
            </div>

            <div class="fixes-container" id="fixes-list">
                <div class="empty-state">
                    <p>No fixes generated yet</p>
                    <p class="empty-state-help">Click "Get AI Fix" on any issue to generate a solution</p>
                </div>
            </div>
        </div>

        <!-- CHAT TAB -->
        <div class="tab-pane" id="chat">
            <div class="section">
                <h3>üí¨ AI Chat Assistant</h3>
                
                <div class="chat-messages" id="chat-messages">
                    <div class="chat-welcome">
                        <h3>üëã Hello!</h3>
                        <p>Ask me anything about web troubleshooting, errors, or how to fix issues on this page.</p>
                    </div>
                </div>

                <div class="chat-suggestions">
                    <div class="suggestion-chip" data-suggestion="What errors are on this page?">Errors?</div>
                    <div class="suggestion-chip" data-suggestion="How can I improve performance?">Performance</div>
                    <div class="suggestion-chip" data-suggestion="What does this error mean?">Help</div>
                </div>

                <div class="chat-input-container">
                    <input 
                        type="text" 
                        class="chat-input" 
                        id="chat-input" 
                        placeholder="Ask a question..." 
                        style="margin-bottom: 8px; width: 100%; display: block;"
                    >
                    <button class="btn-send" id="chat-send-btn">
                        <span>üì§</span>
                        Send
                    </button>
                </div>
            </div>
        </div>

        <!-- SETTINGS TAB -->
        <div class="tab-pane" id="settings">
            <div class="section">
                <h3>‚öôÔ∏è Preferences</h3>

                <div class="settings-section">
                    <h3>Monitoring</h3>
                    <div class="setting-item">
                        <div class="setting-info">
                            <label class="setting-label">Auto Generate Fixes</label>
                            <span class="setting-desc">Automatically create fixes for detected issues</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="auto-generate-fixes" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <label class="setting-label">Show AI Suggestions</label>
                            <span class="setting-desc">Display AI-powered recommendations</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="show-ai-suggestions" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <label class="setting-label">Monitor Console</label>
                            <span class="setting-desc">Track JavaScript errors and warnings</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="monitor-console" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <label class="setting-label">Monitor Network</label>
                            <span class="setting-desc">Track network requests and failures</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="monitor-network" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <label class="setting-label">Monitor Performance</label>
                            <span class="setting-desc">Track page performance metrics</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="monitor-performance" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <label class="setting-label">Visual Guides</label>
                            <span class="setting-desc">Enable interactive visual guidance</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="show-visual-guides" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <label class="setting-label">Notifications</label>
                            <span class="setting-desc">Show browser notifications for critical issues</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="show-notifications">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Data Management</h3>
                    <button class="action-btn secondary" id="export-btn" style="width: 100%; margin-bottom: 8px;">
                        <span>üíæ</span>
                        Export Report
                    </button>
                    <button class="action-btn secondary" id="view-logs-btn" style="width: 100%;">
                        <span>üìã</span>
                        View Logs
                    </button>
                </div>
            </div>

            <div class="section">
                <h3>‚ÑπÔ∏è About</h3>
                <div class="settings-section">
                    <div class="about-info">
                        <p><strong>Dark Voir AI Troubleshooter</strong></p>
                        <p>Version <code>3.0.0</code></p>
                        <p style="margin-top: 8px; color: #666; font-size: 10px;">
                            Powered by Chrome Built-in AI (Gemini Nano) for intelligent troubleshooting with visual guidance.
                        </p>
                        
                        <div class="api-status" style="margin-top: 12px;">
                            <p style="font-weight: 600; margin-bottom: 6px;">Available APIs:</p>
                            <ul>
                                <li id="api-prompt">‚úì Prompt API (Gemini Nano)</li>
                                <li id="api-writer">‚úó Writer API</li>
                                <li id="api-rewriter">‚úó Rewriter API</li>
                                <li id="api-summarizer">‚úó Summarizer API</li>
                                <li id="api-translator">‚úó Translator API</li>
                            </ul>
                        </div>

                        <div class="help-text" style="margin-top: 12px; font-size: 10px;">
                            <strong>Enable Chrome AI:</strong><br>
                            Visit <code>chrome://flags/#prompt-api-for-gemini-nano</code> and enable the flag.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- SCRIPTS -->
    <script src="ai-helper.js"></script>
    <script src="popup.js"></script>
</body>
</html>